

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Web Application &mdash; Map Viewer 2.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="&lt;no title&gt;" href="../setup.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Map Viewer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user.html">User Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Web Application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-setup-steps">The setup steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-firebase">Setting up firebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-to-your-server">Deploying to your server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-layers">Adding layers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Map Viewer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../setup.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Web Application</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/setup/webapp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="web-application">
<h1>Web Application<a class="headerlink" href="#web-application" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt><strong>This app is created to run in any web server environment.</strong></dt>
<dd><p class="first">Because we wanted this application to be server agnostic we decided to use firebase to store our data.  This eliminates
the need to have different setup requirements for different operating systems and also eliminates the need to setup a database.
You will have to create a firebase project and then enter the details in the application, but that is all that is needed.</p>
<p class="last">You can find a working demo here at <a class="reference external" href="https://mapviewer.servirglobal.net">https://mapviewer.servirglobal.net</a></p>
</dd>
</dl>
<div class="section" id="the-setup-steps">
<h2>The setup steps<a class="headerlink" href="#the-setup-steps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#setting-up-firebase">Setting up firebase</a></li>
<li><a class="reference internal" href="#deploying-to-your-server">Deploying to your server</a></li>
<li><a class="reference internal" href="#adding-layers">Adding layers</a></li>
</ul>
</div>
<div class="section" id="setting-up-firebase">
<h2>Setting up firebase<a class="headerlink" href="#setting-up-firebase" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Start by navigating to <a class="reference external" href="https://console.firebase.google.com/">https://console.firebase.google.com</a>.  If you are not signed in to your
google account it will ask you to do so before it takes you to the console.</p>
<p>Once at the console you will:</p>
<ul class="simple">
<li>Click the Add project square.</li>
<li>Enter mapviewer in the project name box</li>
<li>Check both of the checkboxes to accept the terms.</li>
<li>Click Create project</li>
<li>Click Continue</li>
<li>Click the button that looks like &lt;/&gt; Add Firebase to your web app</li>
<li>Copy the code snippet that is provided, set aside in a text editor and close the dialog box</li>
<li>Expand Develop in the left menu panel</li>
<li>Click Database</li>
<li>Find the Cloud Firestore section (they move it frequently, currently it is at the top)</li>
<li>Click Create database</li>
<li>Click Enable (leave the default ‘Start in locked mode’)</li>
<li>Click rules and remove the code that is there, rpelace it with the following Where it says EnterYourGoogleAccountEmail replace with your email.  I have the code below so you can see the pattern to add more admin users.</li>
</ul>
<p>if you want more add || request.auth.uid != null &amp;&amp; request.auth.token.email == ‘EnterAnotherAdminUsersGoogleAccountEmail’ before the semicolon  If you don’t need the second user remove that line i added.  You will need at minimum
to add your account to administer the application</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="n">cloud</span><span class="o">.</span><span class="n">firestore</span> <span class="p">{</span>
        <span class="n">match</span> <span class="o">/</span><span class="n">databases</span><span class="o">/</span><span class="p">{</span><span class="n">database</span><span class="p">}</span><span class="o">/</span><span class="n">documents</span> <span class="p">{</span>
                <span class="n">match</span> <span class="o">/</span><span class="p">{</span><span class="n">document</span><span class="o">=**</span><span class="p">}</span> <span class="p">{</span>
                <span class="n">allow</span> <span class="n">read</span><span class="p">:</span> <span class="k">if</span> <span class="n">true</span><span class="p">;</span>
                <span class="n">allow</span> <span class="n">write</span><span class="p">:</span> <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">uid</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="n">request</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">token</span><span class="o">.</span><span class="n">email</span> <span class="o">==</span> <span class="s1">&#39;EnterYourGoogleAccountEmail&#39;</span> <span class="o">||</span> <span class="n">request</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">uid</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="n">request</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">token</span><span class="o">.</span><span class="n">email</span> <span class="o">==</span> <span class="s1">&#39;EnterAnotherAdminUsersGoogleAccountEmail&#39;</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Click Data tab at the top</li>
<li>Click Add collection</li>
<li>Type map-writer</li>
<li>Click Auto ID</li>
<li>Enter canwrite for the field</li>
<li>Enter map-writer in the value field</li>
<li>Click Add</li>
<li>Click Authentication in the top left of the side menu</li>
<li>Click Sign-in method</li>
<li>Click Google</li>
<li>Select your Project support email</li>
<li>You can add your domain here as well as a development donain such as <a class="reference external" href="http://localhost:SomePortNumber">http://localhost:SomePortNumber</a></li>
<li>Toggle the enabled button</li>
<li>Click Save</li>
</ul>
<p>That’s all for setting up your firebase!</p>
</div></blockquote>
</div>
<div class="section" id="deploying-to-your-server">
<h2>Deploying to your server<a class="headerlink" href="#deploying-to-your-server" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>On any web server copy the files from <a class="reference external" href="https://github.com/SERVIR/MapViewer/">https://github.com/SERVIR/MapViewer</a>
into the folder you would like to publish.  Open the file js/firebase.js go to the code that we set aside earlier.
Copy everything inside the {  } and replace the same in firebase.js (see example below.)  Save the file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apiKey</span><span class="p">:</span> <span class="s2">&quot;khjfakdhfr9ierhfifhu39849348&quot;</span><span class="p">,</span>
<span class="n">authDomain</span><span class="p">:</span> <span class="s2">&quot;mapviewer-11119.firebaseapp.com&quot;</span><span class="p">,</span>
<span class="n">databaseURL</span><span class="p">:</span> <span class="s2">&quot;https://mapviewer-11119.firebaseio.com&quot;</span><span class="p">,</span>
<span class="n">projectId</span><span class="p">:</span> <span class="s2">&quot;mapviewer-11119&quot;</span><span class="p">,</span>
<span class="n">storageBucket</span><span class="p">:</span> <span class="s2">&quot;mapviewer-11119.appspot.com&quot;</span><span class="p">,</span>
<span class="n">messagingSenderId</span><span class="p">:</span> <span class="s2">&quot;665544332211&quot;</span>
</pre></div>
</div>
<p>Setup the routing to the application as you would with any application on your server.</p>
</div></blockquote>
</div>
<div class="section" id="adding-layers">
<h2>Adding layers<a class="headerlink" href="#adding-layers" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>In a browser navigate to your application /admin.html (for my dev server it’s <a class="reference external" href="http://localhost:53530/admin.html">http://localhost:53530/admin.html</a> yours will be different)
Click Login with Google and login.  Begin adding your data layers.  Here is a sample that you can test out if you would like.</p>
<ul class="simple">
<li>Display Name: Ocean Bathymetry (ETOPO1)</li>
<li>Layer region: Global</li>
<li>Layer category: Water</li>
<li>Layer opacity: 1</li>
<li>Service url: <a class="reference external" href="https://gis1.servirglobal.net/arcgis/services/Global/Global_Bathymetry/MapServer/WMSServer">https://gis1.servirglobal.net/arcgis/services/Global/Global_Bathymetry/MapServer/WMSServer</a></li>
<li>Description: Oceanic surface model (ocean depths), integrated by NOAA/NESDIS from a diverse source of global and regional datasets, 2009. Source: Amante, C. and B. W. Eakins, ETOPO1 1 Arc-Minute Global Relief Model: Procedures, Data Sources and Analysis. NOAA Technical Memorandum NESDIS NGDC-24, 19 pp, March 2009</li>
<li>Provider url: <a class="reference external" href="http://gis1.servirglobal.net/arcgis/rest/services/Global/Global_Bathymetry/MapServer">http://gis1.servirglobal.net/arcgis/rest/services/Global/Global_Bathymetry/MapServer</a></li>
<li>Legend url: <a class="reference external" href="http://gis1.servirglobal.net/arcgis/rest/services/Global/Global_Bathymetry/MapServer/legend?f=pjson">http://gis1.servirglobal.net/arcgis/rest/services/Global/Global_Bathymetry/MapServer/legend?f=pjson</a></li>
<li>Layers: 0</li>
<li>Is Time Series [ ] unchecked</li>
<li>Parameters:</li>
</ul>
<p>After adding click the Map Viewer link at the top to go to the user view of the application.</p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../setup.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Billy Ashmall.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>